WITH source AS (

    SELECT * 
    FROM {{ source('sheetload','rep_quotas_full_fy2020') }}
    
), final AS (

    SELECT
    regexp_replace(SPLIT(timestamp, ' ')[0],'"\""','')    AS date,
    'Anonymous'                                           AS employee_name, 
    ZEROIFNULL(NULLIF("SATISFACTION_SCORE",''))::INTEGER  AS satisfaction_score,
    ZEROIFNULL(NULLIF("RECOMMEND_TO_FRIEND",''))::INTEGER AS recommend_to_friend
    FROM source
    WHERE DATE != ''
      
) 


SELECT
    date::DATE AS completed_date, 
    employee_name,
    satisfaction_score, 
    recommend_to_friend
FROM final