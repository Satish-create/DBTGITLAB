connection_info:
  database: GITLAB_COM_DB_NAME
  host: GITLAB_COM_DB_HOST
  pass: GITLAB_COM_DB_PASS
  port: GITLAB_COM_PG_PORT
  user: GITLAB_COM_DB_USER
tables:
  cluster_1:
    dbt_source_model: true
    export_schema: 'gitlab_dotcom'
    export_table: 'gitlab_pgp_export'
    export_table_primary_key: max_created_at
    import_db: GITLAB_DB
    import_query: |-
        SELECT 'gitlab_db_in_product_marketing_emails' AS table_name
        ,'created_at' as count_type
        , DATE(created_at) as date 
        , count(*) as number_of_records
        FROM in_product_marketing_emails
        WHERE DATE(created_at) > current_date - interval '10' day
        GROUP BY 1,2,3
        UNION ALL
        SELECT 'gitlab_db_in_product_marketing_emails' AS table_name
        ,'updated_at' as count_type
        , DATE(updated_at) as date
        , count(*) as number_of_records
        FROM in_product_marketing_emails
        WHERE DATE(updated_at) > current_date - interval '10' day
        GROUP BY 1,2,3
        UNION ALL
        SELECT 'gitlab_db_clusters' AS table_name
        ,'created_at' as count_type
        , DATE(created_at) as date 
        , count(*) as number_of_records
        FROM clusters
        WHERE DATE(created_at) > current_date - interval '10' day
        GROUP BY 1,2,3
        UNION ALL
        SELECT 'gitlab_db_clusters' AS table_name
        ,'updated_at' as count_type
        , DATE(updated_at) as date
        , count(*) as number_of_records
        FROM clusters
        WHERE DATE(updated_at) > current_date - interval '10' day
        GROUP BY 1,2,3
        UNION ALL
        SELECT 'gitlab_db_cluster_projects' AS table_name
        ,'created_at' as count_type
        , DATE(created_at) as date 
        , count(*) as number_of_records
        FROM cluster_projects
        WHERE DATE(created_at) > current_date - interval '8' day
        GROUP BY 1,2,3
        UNION ALL
        SELECT 'gitlab_db_cluster_projects' AS table_name
        ,'updated_at' as count_type
        , DATE(updated_at) as date
        , count(*) as number_of_records
        FROM cluster_projects
        WHERE DATE(updated_at) > current_date - interval '8' day
        GROUP BY 1,2,3
        UNION ALL
        SELECT 'gitlab_db_sprints' AS table_name
        ,'created_at' as count_type
        , DATE(created_at) as date 
        , count(*) as number_of_records
        FROM sprints
        WHERE DATE(created_at) > current_date - interval '8' day
        GROUP BY 1,2,3
        UNION ALL
        SELECT 'gitlab_db_sprints' AS table_name
        ,'updated_at' as count_type
        , DATE(updated_at) as date
        , count(*) as number_of_records
        FROM sprints
        WHERE DATE(updated_at) > current_date - interval '8' day
        GROUP BY 1,2,3
        UNION ALL
        SELECT 'gitlab_db_clusters_applications_runners' AS table_name
        ,'created_at' as count_type
        , DATE(created_at) as date 
        , count(*) as number_of_records
        FROM clusters_applications_runners
        WHERE DATE(created_at) > current_date - interval '8' day
        GROUP BY 1,2,3
        UNION ALL
        SELECT 'gitlab_db_clusters_applications_runners' AS table_name
        ,'updated_at' as count_type
        , DATE(updated_at) as date
        , count(*) as number_of_records
        FROM clusters_applications_runners
        WHERE DATE(updated_at) > current_date - interval '8' day
        GROUP BY 1,2,3
        UNION ALL
        SELECT 'gitlab_db_users_ops_dashboard_projects' AS table_name
        ,'created_at' as count_type
        , DATE(created_at) as date 
        , count(*) as number_of_records
        FROM users_ops_dashboard_projects
        WHERE DATE(created_at) > current_date - interval '8' day
        GROUP BY 1,2,3
        UNION ALL
        SELECT 'gitlab_db_users_ops_dashboard_projects' AS table_name
        ,'updated_at' as count_type
        , DATE(updated_at) as date
        , count(*) as number_of_records
        FROM users_ops_dashboard_projects
        WHERE DATE(updated_at) > current_date - interval '8' day
        GROUP BY 1,2,3
        UNION ALL
        SELECT 'gitlab_db_clusters_applications_prometheus' AS table_name
        ,'created_at' as count_type
        , DATE(created_at) as date 
        , count(*) as number_of_records
        FROM clusters_applications_prometheus
        WHERE DATE(created_at) > current_date - interval '8' day
        GROUP BY 1,2,3
        UNION ALL
        SELECT 'gitlab_db_clusters_applications_prometheus' AS table_name
        ,'updated_at' as count_type
        , DATE(updated_at) as date
        , count(*) as number_of_records
        FROM clusters_applications_prometheus
        WHERE DATE(updated_at) > current_date - interval '8' day
        GROUP BY 1,2,3
        UNION ALL
        SELECT 'gitlab_db_prometheus_alerts' AS table_name
        ,'created_at' as count_type
        , DATE(created_at) as date 
        , count(*) as number_of_records
        FROM prometheus_alerts
        WHERE DATE(created_at) > current_date - interval '8' day
        GROUP BY 1,2,3
        UNION ALL
        SELECT 'gitlab_db_prometheus_alerts' AS table_name
        ,'updated_at' as count_type
        , DATE(updated_at) as date
        , count(*) as number_of_records
        FROM prometheus_alerts
        WHERE DATE(updated_at) > current_date - interval '8' day
        GROUP BY 1,2,3
        UNION ALL
        SELECT 'gitlab_db_clusters_applications_ingress' AS table_name
        ,'created_at' as count_type
        , DATE(created_at) as date 
        , count(*) as number_of_records
        FROM clusters_applications_ingress
        WHERE DATE(created_at) > current_date - interval '8' day
        GROUP BY 1,2,3
        UNION ALL
        SELECT 'gitlab_db_clusters_applications_ingress' AS table_name
        ,'updated_at' as count_type
        , DATE(updated_at) as date
        , count(*) as number_of_records
        FROM clusters_applications_ingress
        WHERE DATE(updated_at) > current_date - interval '8' day
        GROUP BY 1,2,3
        UNION ALL
        SELECT 'gitlab_db_clusters_applications_helm' AS table_name
        ,'created_at' as count_type
        , DATE(created_at) as date 
        , count(*) as number_of_records
        FROM clusters_applications_helm
        WHERE DATE(created_at) > current_date - interval '8' day
        GROUP BY 1,2,3
        UNION ALL
        SELECT 'gitlab_db_clusters_applications_helm' AS table_name
        ,'updated_at' as count_type
        , DATE(updated_at) as date
        , count(*) as number_of_records
        FROM clusters_applications_helm
        WHERE DATE(updated_at) > current_date - interval '8' day
        GROUP BY 1,2,3
        UNION ALL
        SELECT 'gitlab_db_path_locks' AS table_name
        ,'created_at' as count_type
        , DATE(created_at) as date 
        , count(*) as number_of_records
        FROM path_locks
        WHERE DATE(created_at) > current_date - interval '8' day
        GROUP BY 1,2,3
        UNION ALL
        SELECT 'gitlab_db_path_locks' AS table_name
        ,'updated_at' as count_type
        , DATE(updated_at) as date
        , count(*) as number_of_records
        FROM path_locks
        WHERE DATE(updated_at) > current_date - interval '8' day
        GROUP BY 1,2,3
        UNION ALL
        SELECT 'gitlab_db_csv_issue_imports' AS table_name
        ,'created_at' as count_type
        , DATE(created_at) as date 
        , count(*) as number_of_records
        FROM csv_issue_imports
        WHERE DATE(created_at) > current_date - interval '8' day
        GROUP BY 1,2,3
        UNION ALL
        SELECT 'gitlab_db_csv_issue_imports' AS table_name
        ,'updated_at' as count_type
        , DATE(updated_at) as date
        , count(*) as number_of_records
        FROM csv_issue_imports
        WHERE DATE(updated_at) > current_date - interval '8' day
        GROUP BY 1,2,3
        UNION ALL
        SELECT 'gitlab_db_cluster_providers_gcp' AS table_name
        ,'created_at' as count_type
        , DATE(created_at) as date 
        , count(*) as number_of_records
        FROM cluster_providers_gcp
        WHERE DATE(created_at) > current_date - interval '8' day
        GROUP BY 1,2,3
        UNION ALL
        SELECT 'gitlab_db_cluster_providers_gcp' AS table_name
        ,'updated_at' as count_type
        , DATE(updated_at) as date
        , count(*) as number_of_records
        FROM cluster_providers_gcp
        WHERE DATE(updated_at) > current_date - interval '8' day
        GROUP BY 1,2,3
        UNION ALL
        SELECT 'gitlab_db_requirements' AS table_name
        ,'created_at' as count_type
        , DATE(created_at) as date 
        , count(*) as number_of_records
        FROM requirements
        WHERE DATE(created_at) > current_date - interval '8' day
        GROUP BY 1,2,3
        UNION ALL
        SELECT 'gitlab_db_requirements' AS table_name
        ,'updated_at' as count_type
        , DATE(updated_at) as date
        , count(*) as number_of_records
        FROM requirements
        WHERE DATE(updated_at) > current_date - interval '8' day
        GROUP BY 1,2,3
        UNION ALL
        SELECT 'gitlab_db_vulnerability_issue_links' AS table_name
        ,'created_at' as count_type
        , DATE(created_at) as date 
        , count(*) as number_of_records
        FROM vulnerability_issue_links
        WHERE DATE(created_at) > current_date - interval '8' day
        GROUP BY 1,2,3
        UNION ALL
        SELECT 'gitlab_db_vulnerability_issue_links' AS table_name
        ,'updated_at' as count_type
        , DATE(updated_at) as date
        , count(*) as number_of_records
        FROM vulnerability_issue_links
        WHERE DATE(updated_at) > current_date - interval '8' day
        GROUP BY 1,2,3
        UNION ALL
        SELECT 'gitlab_db_clusters_applications_cert_managers' AS table_name
        ,'created_at' as count_type
        , DATE(created_at) as date 
        , count(*) as number_of_records
        FROM clusters_applications_cert_managers
        WHERE DATE(created_at) > current_date - interval '8' day
        GROUP BY 1,2,3
        UNION ALL
        SELECT 'gitlab_db_clusters_applications_cert_managers' AS table_name
        ,'updated_at' as count_type
        , DATE(updated_at) as date
        , count(*) as number_of_records
        FROM clusters_applications_cert_managers
        WHERE DATE(updated_at) > current_date - interval '8' day
        GROUP BY 1,2,3
        UNION ALL
        SELECT 'gitlab_db_operations_feature_flags' AS table_name
        ,'created_at' as count_type
        , DATE(created_at) as date 
        , count(*) as number_of_records
        FROM operations_feature_flags
        WHERE DATE(created_at) > current_date - interval '8' day
        GROUP BY 1,2,3
        UNION ALL
        SELECT 'gitlab_db_requirements_management_test_reports' AS table_name
        ,'created_at' as count_type
        , DATE(created_at) as date 
        , count(*) as number_of_records
        FROM requirements_management_test_reports
        WHERE DATE(created_at) > current_date - interval '8' day
        GROUP BY 1,2,3
        UNION ALL
        SELECT 'gitlab_db_issues_prometheus_alert_events' AS table_name
        ,'created_at' as count_type
        , DATE(created_at) as date 
        , count(*) as number_of_records
        FROM issues_prometheus_alert_events
        WHERE DATE(created_at) > current_date - interval '8' day
        GROUP BY 1,2,3
        UNION ALL
        SELECT 'gitlab_db_issues_prometheus_alert_events' AS table_name
        ,'updated_at' as count_type
        , DATE(updated_at) as date
        , count(*) as number_of_records
        FROM issues_prometheus_alert_events
        WHERE DATE(updated_at) > current_date - interval '8' day
        GROUP BY 1,2,3
        UNION ALL
        SELECT 'gitlab_db_clusters_applications_elastic_stacks' AS table_name
        ,'created_at' as count_type
        , DATE(created_at) as date 
        , count(*) as number_of_records
        FROM clusters_applications_elastic_stacks
        WHERE DATE(created_at) > current_date - interval '8' day
        GROUP BY 1,2,3
        UNION ALL
        SELECT 'gitlab_db_clusters_applications_elastic_stacks' AS table_name
        ,'updated_at' as count_type
        , DATE(updated_at) as date
        , count(*) as number_of_records
        FROM clusters_applications_elastic_stacks
        WHERE DATE(updated_at) > current_date - interval '8' day
        GROUP BY 1,2,3
        UNION ALL
        SELECT 'gitlab_db_group_import_states' AS table_name
        ,'created_at' as count_type
        , DATE(created_at) as date 
        , count(*) as number_of_records
        FROM group_import_states
        WHERE DATE(created_at) > current_date - interval '8' day
        GROUP BY 1,2,3
        UNION ALL
        SELECT 'gitlab_db_group_import_states' AS table_name
        ,'updated_at' as count_type
        , DATE(updated_at) as date
        , count(*) as number_of_records
        FROM group_import_states
        WHERE DATE(updated_at) > current_date - interval '8' day
        GROUP BY 1,2,3
        UNION ALL
        SELECT 'gitlab_db_clusters_applications_knative' AS table_name
        ,'created_at' as count_type
        , DATE(created_at) as date 
        , count(*) as number_of_records
        FROM clusters_applications_knative
        WHERE DATE(created_at) > current_date - interval '8' day
        GROUP BY 1,2,3
        UNION ALL
        SELECT 'gitlab_db_clusters_applications_knative' AS table_name
        ,'updated_at' as count_type
        , DATE(updated_at) as date
        , count(*) as number_of_records
        FROM clusters_applications_knative
        WHERE DATE(updated_at) > current_date - interval '8' day
        GROUP BY 1,2,3
        UNION ALL
        SELECT 'gitlab_db_analytics_cycle_analytics_group_stages' AS table_name
        ,'created_at' as count_type
        , DATE(created_at) as date 
        , count(*) as number_of_records
        FROM analytics_cycle_analytics_group_stages
        WHERE DATE(created_at) > current_date - interval '8' day
        GROUP BY 1,2,3
        UNION ALL
        SELECT 'gitlab_db_analytics_cycle_analytics_group_stages' AS table_name
        ,'updated_at' as count_type
        , DATE(updated_at) as date
        , count(*) as number_of_records
        FROM analytics_cycle_analytics_group_stages
        WHERE DATE(updated_at) > current_date - interval '8' day
        GROUP BY 1,2,3
        UNION ALL
        SELECT 'gitlab_db_cluster_providers_aws' AS table_name
        ,'created_at' as count_type
        , DATE(created_at) as date 
        , count(*) as number_of_records
        FROM cluster_providers_aws
        WHERE DATE(created_at) > current_date - interval '8' day
        GROUP BY 1,2,3
        UNION ALL
        SELECT 'gitlab_db_cluster_providers_aws' AS table_name
        ,'updated_at' as count_type
        , DATE(updated_at) as date
        , count(*) as number_of_records
        FROM cluster_providers_aws
        WHERE DATE(updated_at) > current_date - interval '8' day
        GROUP BY 1,2,3
        UNION ALL
        SELECT 'gitlab_db_jira_imports' AS table_name
        ,'created_at' as count_type
        , DATE(created_at) as date 
        , count(*) as number_of_records
        FROM jira_imports
        WHERE DATE(created_at) > current_date - interval '8' day
        GROUP BY 1,2,3
        UNION ALL
        SELECT 'gitlab_db_jira_imports' AS table_name
        ,'updated_at' as count_type
        , DATE(updated_at) as date
        , count(*) as number_of_records
        FROM jira_imports
        WHERE DATE(updated_at) > current_date - interval '8' day
        GROUP BY 1,2,3
        UNION ALL
        SELECT 'gitlab_db_bulk_imports' AS table_name
        ,'created_at' as count_type
        , DATE(created_at) as date 
        , count(*) as number_of_records
        FROM bulk_imports
        WHERE DATE(created_at) > current_date - interval '8' day
        GROUP BY 1,2,3
        UNION ALL
        SELECT 'gitlab_db_bulk_imports' AS table_name
        ,'updated_at' as count_type
        , DATE(updated_at) as date
        , count(*) as number_of_records
        FROM bulk_imports
        WHERE DATE(updated_at) > current_date - interval '8' day
        GROUP BY 1,2,3
        UNION ALL
        SELECT 'gitlab_db_clusters_applications_crossplane' AS table_name
        ,'created_at' as count_type
        , DATE(created_at) as date 
        , count(*) as number_of_records
        FROM clusters_applications_crossplane
        WHERE DATE(created_at) > current_date - interval '8' day
        GROUP BY 1,2,3
        UNION ALL
        SELECT 'gitlab_db_clusters_applications_crossplane' AS table_name
        ,'updated_at' as count_type
        , DATE(updated_at) as date
        , count(*) as number_of_records
        FROM clusters_applications_crossplane
        WHERE DATE(updated_at) > current_date - interval '8' day
        GROUP BY 1,2,3
        UNION ALL
        SELECT 'gitlab_db_alert_management_http_integrations' AS table_name
        ,'created_at' as count_type
        , DATE(created_at) as date 
        , count(*) as number_of_records
        FROM alert_management_http_integrations
        WHERE DATE(created_at) > current_date - interval '8' day
        GROUP BY 1,2,3
        UNION ALL
        SELECT 'gitlab_db_alert_management_http_integrations' AS table_name
        ,'updated_at' as count_type
        , DATE(updated_at) as date
        , count(*) as number_of_records
        FROM alert_management_http_integrations
        WHERE DATE(updated_at) > current_date - interval '8' day
        GROUP BY 1,2,3
        UNION ALL
        SELECT 'gitlab_db_alert_management_http_integrations' AS table_name
        ,'created_at' as count_type
        , DATE(created_at) as date 
        , count(*) as number_of_records
        FROM alert_management_http_integrations
        WHERE DATE(created_at) > current_date - interval '8' day
        GROUP BY 1,2,3
        UNION ALL
        SELECT 'gitlab_db_alert_management_http_integrations' AS table_name
        ,'updated_at' as count_type
        , DATE(updated_at) as date
        , count(*) as number_of_records
        FROM alert_management_http_integrations
        WHERE DATE(updated_at) > current_date - interval '8' day
        GROUP BY 1,2,3
        UNION ALL
        SELECT 'gitlab_db_clusters_applications_jupyter' AS table_name
        ,'created_at' as count_type
        , DATE(created_at) as date 
        , count(*) as number_of_records
        FROM clusters_applications_jupyter
        WHERE DATE(created_at) > current_date - interval '8' day
        GROUP BY 1,2,3
        UNION ALL
        SELECT 'gitlab_db_clusters_applications_jupyter' AS table_name
        ,'updated_at' as count_type
        , DATE(updated_at) as date
        , count(*) as number_of_records
        FROM clusters_applications_jupyter
        WHERE DATE(updated_at) > current_date - interval '8' day
        GROUP BY 1,2,3
        UNION ALL
        SELECT 'gitlab_db_zoom_meetings' AS table_name
        ,'created_at' as count_type
        , DATE(created_at) as date 
        , count(*) as number_of_records
        FROM zoom_meetings
        WHERE DATE(created_at) > current_date - interval '8' day
        GROUP BY 1,2,3
        UNION ALL
        SELECT 'gitlab_db_zoom_meetings' AS table_name
        ,'updated_at' as count_type
        , DATE(updated_at) as date
        , count(*) as number_of_records
        FROM zoom_meetings
        WHERE DATE(updated_at) > current_date - interval '8' day
        GROUP BY 1,2,3
        UNION ALL
        SELECT 'gitlab_db_grafana_integrations' AS table_name
        ,'created_at' as count_type
        , DATE(created_at) as date 
        , count(*) as number_of_records
        FROM grafana_integrations
        WHERE DATE(created_at) > current_date - interval '8' day
        GROUP BY 1,2,3
        UNION ALL
        SELECT 'gitlab_db_grafana_integrations' AS table_name
        ,'updated_at' as count_type
        , DATE(updated_at) as date
        , count(*) as number_of_records
        FROM grafana_integrations
        WHERE DATE(updated_at) > current_date - interval '8' day
        GROUP BY 1,2,3
        UNION ALL
        SELECT 'gitlab_db_epic_metrics' AS table_name
        ,'created_at' as count_type
        , DATE(created_at) as date 
        , count(*) as number_of_records
        FROM epic_metrics
        WHERE DATE(created_at) > current_date - interval '8' day
        GROUP BY 1,2,3
        UNION ALL
        SELECT 'gitlab_db_epic_metrics' AS table_name
        ,'updated_at' as count_type
        , DATE(updated_at) as date
        , count(*) as number_of_records
        FROM epic_metrics
        WHERE DATE(updated_at) > current_date - interval '8' day
        GROUP BY 1,2,3
        UNION ALL
        SELECT 'gitlab_db_project_tracing_settings' AS table_name
        ,'created_at' as count_type
        , DATE(created_at) as date 
        , count(*) as number_of_records
        FROM project_tracing_settings
        WHERE DATE(created_at) > current_date - interval '8' day
        GROUP BY 1,2,3
        UNION ALL
        SELECT 'gitlab_db_project_tracing_settings' AS table_name
        ,'updated_at' as count_type
        , DATE(updated_at) as date
        , count(*) as number_of_records
        FROM project_tracing_settings
        WHERE DATE(updated_at) > current_date - interval '8' day
        GROUP BY 1,2,3
        UNION ALL
        SELECT 'gitlab_db_application_settings' AS table_name
        ,'created_at' as count_type
        , DATE(created_at) as date 
        , count(*) as number_of_records
        FROM application_settings
        WHERE DATE(created_at) > current_date - interval '8' day
        GROUP BY 1,2,3
        UNION ALL
        SELECT 'gitlab_db_application_settings' AS table_name
        ,'updated_at' as count_type
        , DATE(updated_at) as date
        , count(*) as number_of_records
        FROM application_settings
        WHERE DATE(updated_at) > current_date - interval '8' day
        GROUP BY 1,2,3
        UNION ALL
        SELECT 'gitlab_db_cluster_agents' AS table_name
        ,'created_at' as count_type
        , DATE(created_at) as date 
        , count(*) as number_of_records
        FROM cluster_agents
        WHERE DATE(created_at) > current_date - interval '8' day
        GROUP BY 1,2,3
        UNION ALL
        SELECT 'gitlab_db_cluster_agents' AS table_name
        ,'updated_at' as count_type
        , DATE(updated_at) as date
        , count(*) as number_of_records
        FROM cluster_agents
        WHERE DATE(updated_at) > current_date - interval '8' day
        GROUP BY 1,2,3
        UNION ALL
        SELECT 'gitlab_db_cluster_agent_tokens' AS table_name
        ,'created_at' as count_type
        , DATE(created_at) as date 
        , count(*) as number_of_records
        FROM cluster_agent_tokens
        WHERE DATE(created_at) > current_date - interval '8' day
        GROUP BY 1,2,3
        UNION ALL
        SELECT 'gitlab_db_cluster_agent_tokens' AS table_name
        ,'updated_at' as count_type
        , DATE(updated_at) as date
        , count(*) as number_of_records
        FROM cluster_agent_tokens
        WHERE DATE(updated_at) > current_date - interval '8' day
        GROUP BY 1,2,3
        UNION ALL
        SELECT 'gitlab_db_issues_self_managed_prometheus_alert_events' AS table_name
        ,'created_at' as count_type
        , DATE(created_at) as date 
        , count(*) as number_of_records
        FROM issues_self_managed_prometheus_alert_events
        WHERE DATE(created_at) > current_date - interval '8' day
        GROUP BY 1,2,3
        UNION ALL
        SELECT 'gitlab_db_issues_self_managed_prometheus_alert_events' AS table_name
        ,'updated_at' as count_type
        , DATE(updated_at) as date
        , count(*) as number_of_records
        FROM issues_self_managed_prometheus_alert_events
        WHERE DATE(updated_at) > current_date - interval '8' day
        GROUP BY 1,2,3
        UNION ALL
        SELECT 'gitlab_db_ldap_group_links' AS table_name
        ,'created_at' as count_type
        , DATE(created_at) as date 
        , count(*) as number_of_records
        FROM ldap_group_links
        WHERE DATE(created_at) > current_date - interval '8' day
        GROUP BY 1,2,3
        UNION ALL
        SELECT 'gitlab_db_ldap_group_links' AS table_name
        ,'updated_at' as count_type
        , DATE(updated_at) as date
        , count(*) as number_of_records
        FROM ldap_group_links
        WHERE DATE(updated_at) > current_date - interval '8' day
        GROUP BY 1,2,3
        UNION ALL
        SELECT 'gitlab_db_clusters_applications_cilium' AS table_name
        ,'created_at' as count_type
        , DATE(created_at) as date 
        , count(*) as number_of_records
        FROM clusters_applications_cilium
        WHERE DATE(created_at) > current_date - interval '8' day
        GROUP BY 1,2,3
        UNION ALL
        SELECT 'gitlab_db_clusters_applications_cilium' AS table_name
        ,'updated_at' as count_type
        , DATE(updated_at) as date
        , count(*) as number_of_records
        FROM clusters_applications_cilium
        WHERE DATE(updated_at) > current_date - interval '8' day
        GROUP BY 1,2,3
        UNION ALL
        SELECT 'gitlab_db_status_page_published_incidents' AS table_name
        ,'created_at' as count_type
        , DATE(created_at) as date 
        , count(*) as number_of_records
        FROM status_page_published_incidents
        WHERE DATE(created_at) > current_date - interval '8' day
        GROUP BY 1,2,3
        UNION ALL
        SELECT 'gitlab_db_status_page_published_incidents' AS table_name
        ,'updated_at' as count_type
        , DATE(updated_at) as date
        , count(*) as number_of_records
        FROM status_page_published_incidents
        WHERE DATE(updated_at) > current_date - interval '8' day
        GROUP BY 1,2,3
        UNION ALL
        SELECT 'gitlab_db_status_page_settings' AS table_name
        ,'created_at' as count_type
        , DATE(created_at) as date 
        , count(*) as number_of_records
        FROM status_page_settings
        WHERE DATE(created_at) > current_date - interval '8' day
        GROUP BY 1,2,3
        UNION ALL
        SELECT 'gitlab_db_status_page_settings' AS table_name
        ,'updated_at' as count_type
        , DATE(updated_at) as date
        , count(*) as number_of_records
        FROM status_page_settings
        WHERE DATE(updated_at) > current_date - interval '8' day
        GROUP BY 1,2,3
        UNION ALL
        SELECT 'gitlab_db_licenses' AS table_name
        ,'created_at' as count_type
        , DATE(created_at) as date 
        , count(*) as number_of_records
        FROM licenses
        WHERE DATE(created_at) > current_date - interval '8' day
        GROUP BY 1,2,3
        UNION ALL
        SELECT 'gitlab_db_licenses' AS table_name
        ,'updated_at' as count_type
        , DATE(updated_at) as date
        , count(*) as number_of_records
        FROM licenses
        WHERE DATE(updated_at) > current_date - interval '8' day
        GROUP BY 1,2,3
cluster_2:
  dbt_source_model: true
  export_schema: 'gitlab_dotcom'
  export_table: 'gitlab_pgp_export'
  export_table_primary_key: max_created_at
  import_db: GITLAB_DB
  import_query: |-
      SELECT 'gitlab_db_alert_management_alerts' AS table_name
      ,'created_at' as count_type
      , DATE(created_at) as date 
      , count(*) as number_of_records
      FROM alert_management_alerts
      WHERE DATE(created_at) > current_date - interval '8' day
      GROUP BY 1,2,3
      UNION ALL
      SELECT 'gitlab_db_alert_management_alerts' AS table_name
      ,'updated_at' as count_type
      , DATE(updated_at) as date
      , count(*) as number_of_records
      FROM alert_management_alerts
      WHERE DATE(updated_at) > current_date - interval '8' day
      GROUP BY 1,2,3
      UNION ALL
      SELECT 'gitlab_db_epics' AS table_name
      ,'created_at' as count_type
      , DATE(created_at) as date 
      , count(*) as number_of_records
      FROM epics
      WHERE DATE(created_at) > current_date - interval '8' day
      GROUP BY 1,2,3
      UNION ALL
      SELECT 'gitlab_db_epics' AS table_name
      ,'updated_at' as count_type
      , DATE(updated_at) as date
      , count(*) as number_of_records
      FROM epics
      WHERE DATE(updated_at) > current_date - interval '8' day
      GROUP BY 1,2,3
      UNION ALL
      SELECT 'gitlab_db_snippets' AS table_name
      ,'created_at' as count_type
      , DATE(created_at) as date 
      , count(*) as number_of_records
      FROM snippets
      WHERE DATE(created_at) > current_date - interval '8' day
      GROUP BY 1,2,3
      UNION ALL
      SELECT 'gitlab_db_snippets' AS table_name
      ,'updated_at' as count_type
      , DATE(updated_at) as date
      , count(*) as number_of_records
      FROM snippets
      WHERE DATE(updated_at) > current_date - interval '8' day
      GROUP BY 1,2,3
      UNION ALL
      SELECT 'gitlab_db_emails' AS table_name
      ,'created_at' as count_type
      , DATE(created_at) as date 
      , count(*) as number_of_records
      FROM emails
      WHERE DATE(created_at) > current_date - interval '8' day
      GROUP BY 1,2,3
      UNION ALL
      SELECT 'gitlab_db_emails' AS table_name
      ,'updated_at' as count_type
      , DATE(updated_at) as date
      , count(*) as number_of_records
      FROM emails
      WHERE DATE(updated_at) > current_date - interval '8' day
      GROUP BY 1,2,3
      UNION ALL
      SELECT 'gitlab_db_jira_tracker_data' AS table_name
      ,'created_at' as count_type
      , DATE(created_at) as date 
      , count(*) as number_of_records
      FROM jira_tracker_data
      WHERE DATE(created_at) > current_date - interval '8' day
      GROUP BY 1,2,3
      UNION ALL
      SELECT 'gitlab_db_jira_tracker_data' AS table_name
      ,'updated_at' as count_type
      , DATE(updated_at) as date
      , count(*) as number_of_records
      FROM jira_tracker_data
      WHERE DATE(updated_at) > current_date - interval '8' day
      GROUP BY 1,2,3
      UNION ALL
      SELECT 'gitlab_db_onboarding_progresses' AS table_name
      ,'created_at' as count_type
      , DATE(created_at) as date 
      , count(*) as number_of_records
      FROM onboarding_progresses
      WHERE DATE(created_at) > current_date - interval '8' day
      GROUP BY 1,2,3
      UNION ALL
      SELECT 'gitlab_db_onboarding_progresses' AS table_name
      ,'updated_at' as count_type
      , DATE(updated_at) as date
      , count(*) as number_of_records
      FROM onboarding_progresses
      WHERE DATE(updated_at) > current_date - interval '8' day
      GROUP BY 1,2,3
      UNION ALL
      SELECT 'gitlab_db_approval_project_rules' AS table_name
      ,'created_at' as count_type
      , DATE(created_at) as date 
      , count(*) as number_of_records
      FROM approval_project_rules
      WHERE DATE(created_at) > current_date - interval '8' day
      GROUP BY 1,2,3
      UNION ALL
      SELECT 'gitlab_db_approval_project_rules' AS table_name
      ,'updated_at' as count_type
      , DATE(updated_at) as date
      , count(*) as number_of_records
      FROM approval_project_rules
      WHERE DATE(updated_at) > current_date - interval '8' day
      GROUP BY 1,2,3
      UNION ALL
      SELECT 'gitlab_db_label_priorities' AS table_name
      ,'created_at' as count_type
      , DATE(created_at) as date 
      , count(*) as number_of_records
      FROM label_priorities
      WHERE DATE(created_at) > current_date - interval '8' day
      GROUP BY 1,2,3
      UNION ALL
      SELECT 'gitlab_db_label_priorities' AS table_name
      ,'updated_at' as count_type
      , DATE(updated_at) as date
      , count(*) as number_of_records
      FROM label_priorities 
      WHERE DATE(updated_at) > current_date - interval '8' day
      GROUP BY 1,2,3
      UNION ALL
      SELECT 'gitlab_db_clusters_kubernetes_namespaces' AS table_name
      ,'created_at' as count_type
      , DATE(created_at) as date 
      , count(*) as number_of_records
      FROM clusters_kubernetes_namespaces
      WHERE DATE(created_at) > current_date - interval '8' day
      GROUP BY 1,2,3
      UNION ALL
      SELECT 'gitlab_db_clusters_kubernetes_namespaces' AS table_name
      ,'updated_at' as count_type
      , DATE(updated_at) as date
      , count(*) as number_of_records
      FROM clusters_kubernetes_namespaces 
      WHERE DATE(updated_at) > current_date - interval '8' day
      GROUP BY 1,2,3
      UNION ALL
      SELECT 'gitlab_db_vulnerability_feedback' AS table_name
      ,'created_at' as count_type
      , DATE(created_at) as date 
      , count(*) as number_of_records
      FROM vulnerability_feedback
      WHERE DATE(created_at) > current_date - interval '8' day
      GROUP BY 1,2,3
      UNION ALL
      SELECT 'gitlab_db_vulnerability_feedback' AS table_name
      ,'updated_at' as count_type
      , DATE(updated_at) as date
      , count(*) as number_of_records
      FROM vulnerability_feedback 
      WHERE DATE(updated_at) > current_date - interval '8' day
      GROUP BY 1,2,3
      UNION ALL
      SELECT 'gitlab_db_approver_groups' AS table_name
      ,'created_at' as count_type
      , DATE(created_at) as date 
      , count(*) as number_of_records
      FROM approver_groups
      WHERE DATE(created_at) > current_date - interval '8' day
      GROUP BY 1,2,3
      UNION ALL
      SELECT 'gitlab_db_approver_groups' AS table_name
      ,'updated_at' as count_type
      , DATE(updated_at) as date
      , count(*) as number_of_records
      FROM approver_groups 
      WHERE DATE(updated_at) > current_date - interval '8' day
      GROUP BY 1,2,3
      UNION ALL
      SELECT 'gitlab_db_vulnerability_scanners' AS table_name
      ,'created_at' as count_type
      , DATE(created_at) as date 
      , count(*) as number_of_records
      FROM vulnerability_scanners
      WHERE DATE(created_at) > current_date - interval '8' day
      GROUP BY 1,2,3
      UNION ALL
      SELECT 'gitlab_db_vulnerability_scanners' AS table_name
      ,'updated_at' as count_type
      , DATE(updated_at) as date
      , count(*) as number_of_records
      FROM vulnerability_scanners 
      WHERE DATE(updated_at) > current_date - interval '8' day
      GROUP BY 1,2,3
      UNION ALL
      SELECT 'gitlab_db_ci_triggers' AS table_name
      ,'created_at' as count_type
      , DATE(created_at) as date 
      , count(*) as number_of_records
      FROM ci_triggers
      WHERE DATE(created_at) > current_date - interval '8' day
      GROUP BY 1,2,3
      UNION ALL
      SELECT 'gitlab_db_ci_triggers' AS table_name
      ,'updated_at' as count_type
      , DATE(updated_at) as date
      , count(*) as number_of_records
      FROM ci_triggers 
      WHERE DATE(updated_at) > current_date - interval '8' day
      GROUP BY 1,2,3
      UNION ALL
      SELECT 'gitlab_db_packages_tags' AS table_name
      ,'created_at' as count_type
      , DATE(created_at) as date 
      , count(*) as number_of_records
      FROM packages_tags
      WHERE DATE(created_at) > current_date - interval '8' day
      GROUP BY 1,2,3
      UNION ALL
      SELECT 'gitlab_db_packages_tags' AS table_name
      ,'updated_at' as count_type
      , DATE(updated_at) as date
      , count(*) as number_of_records
      FROM packages_tags 
      WHERE DATE(updated_at) > current_date - interval '8' day
      GROUP BY 1,2,3
      UNION ALL
      SELECT 'gitlab_db_terraform_states' AS table_name
      ,'created_at' as count_type
      , DATE(created_at) as date 
      , count(*) as number_of_records
      FROM terraform_states
      WHERE DATE(created_at) > current_date - interval '8' day
      GROUP BY 1,2,3
      UNION ALL
      SELECT 'gitlab_db_terraform_states' AS table_name
      ,'updated_at' as count_type
      , DATE(updated_at) as date
      , count(*) as number_of_records
      FROM terraform_states 
      WHERE DATE(updated_at) > current_date - interval '8' day
      GROUP BY 1,2,3



